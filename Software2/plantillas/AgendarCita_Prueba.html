<html>
<body>
    
        <form action="/getEspecialidad/" method="GET">
        <div>
            <select required name="especialidad_categoria" > 
                <option selected="selected" disabled>Selecciona la opción ...</option> 
                {% for elemento in list %}
                    <option value="{{elemento.especialidad}}">{{elemento.especialidad}}</option> 
                {% endfor %}
                <input type="submit" class="btn btn-success" value="seleccionar">
            </select>
        <form>
            <br>
        <form action="/getMedicosByEspecialidad/" method="GET">
            <select required name="especialidad_categoria" > 
                <option selected="selected" disabled>Selecciona la opción ...</option> 
                {% for elemento in lista %}
                    <option value="{{elemento.medico}}">{{elemento.medico}}</option> 
                {% endfor %}
                <input type="submit" class="btn btn-success" value="seleccionar">
            </select>
        <form>
        </div>
        <div>
        <select>
            {{ form.medico.label_tag }} 
            {{ form.medico }}
        </select>
        </div>
        <div>
        <select>
            {{ form.horario.label_tag }} 
            {{ form.horario }}
        </select>
        </div>
        
        <button type="submit">Guardar</button>
    </form>
    <script type="text/javascript">
        $(document).ready(function() {
            $("#id_especialidad").on("change", get_medicos);
            $("#id_especialidad").on("change", get_horarios);
        });

        function get_medicos() {
            var especialidadId = $("#id_especialidad").val();
            if (especialidadId) {
                // Eliminamos las opciones anteriores del select
                $("#id_medico").html("");
                var request = $.ajax({
                    type: "GET",
                    url: "{% url 'get_medicos' %}",
                    data: {
                        "especialidad_id": especialidadId,
                    },
                });
                request.done(function(response) {
                    // Agregamos los resultados al select
                    $("#id_proceso").html(response.medicos);
                    $("#id_horario").html("<option value='' selected='selected'>---------</option>");
                    $("#id_medico, #id_horario").trigger("change");
                });
            } else {
                $("#id_medico").html("<option value='' selected='selected'>---------</option>");
                $("#id_horario").html("<option value='' selected='selected'>---------</option>");
                $("#id_medico, #id_horario").trigger("change");
            }
        }    

        function get_horarios() {
            var medicoId = $("#id_medico").val();
            if (medicoId) {
                // Eliminamos las opciones anteriores del select
                $("#id_horario").html("");
                var request = $.ajax({
                    type: "GET",
                    url: "{% url 'get_horarios' %}",
                    data: {
                        "medico_id": medicoId,
      },
                });
                request.done(function(response) {
                    // Agregamos los resultados al select
                    $("#id_horario").html(response.horarioes);
                    $("#id_horario").trigger("change");
                });
            } else {
                $("#id_horario").html("<option value='' selected='selected'>---------</option>");
                $("#id_horario").trigger("change");
            }
        }
    </script>
</body>
</html>